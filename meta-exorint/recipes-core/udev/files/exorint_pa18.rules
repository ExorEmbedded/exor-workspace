# There are a number of modifiers that are allowed to be used in some
# of the different fields. They provide the following subsitutions:
#
# %n the "kernel number" of the device.
#    For example, 'sda3' has a "kernel number" of '3'
# %e the smallest number for that name which does not matches an existing node
# %k the kernel name for the device
# %M the kernel major number for the device
# %m the kernel minor number for the device
# %b the bus id for the device
# %c the string returned by the PROGRAM
# %s{filename} the content of a sysfs attribute
# %% the '%' char itself
#

SUBSYSTEM=="leds", PROGRAM="/bin/bash -c '/bin/echo 1 > /sys/class/leds/usb0/ports/1-1-port1'"
SUBSYSTEM=="leds", PROGRAM="/bin/bash -c '/bin/echo 1 > /sys/class/leds/usb1/ports/1-1-port2'"

SUBSYSTEM=="leds", KERNEL=="usr|usb_mem_write|con" RUN+="/bin/bash -c '/bin/chown admin /sys/%p/*'"
SUBSYSTEM=="gpio", KERNEL=="gpio5|gpio8|gpio9|gpio116|gpio122", RUN+="/bin/bash -c '/bin/chown admin /sys/%p/*'"

# USB-serial
ACTION=="add", ATTRS{idVendor}=="0986", ATTRS{idProduct}=="0310", RUN+="/bin/sh -c ' \
	if !( cat /sys/bus/usb-serial/drivers/generic/new_id | grep -q 0986[[:space:]]0310 ); then \
		/sbin/modprobe usbserial; \
		echo 0986 0310 > /sys/bus/usb-serial/drivers/generic/new_id; \
	fi'"

ACTION=="add", ATTRS{idVendor}=="0986", ATTRS{idProduct}=="0320", RUN+="/bin/sh -c ' \
	if !( cat /sys/bus/usb-serial/drivers/generic/new_id | grep -q 0986[[:space:]]0320 ); then \
		/sbin/modprobe usbserial; \
		echo 0986 0320 > /sys/bus/usb-serial/drivers/generic/new_id; \
	fi'"

ACTION=="add", ATTRS{idVendor}=="04da", ATTRS{idProduct}=="4201", RUN+="/bin/sh -c ' \
	if !( cat /sys/bus/usb-serial/drivers/generic/new_id | grep -q 04da[[:space:]]4201 ); then \
		/sbin/modprobe usbserial; \
		echo 04da 4201 > /sys/bus/usb-serial/drivers/generic/new_id; \
	fi'"
